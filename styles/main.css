/* Scrollytelling Lab - Styles */

:root {
  --bg: #0b0d10;
  --fg: #f2f5f8;
  --muted: #93a1ad;
  --panel-height: 150vh; /* taller panels for scroll room */
  --overlay-max: 64rem;
  /* Global card defaults (can be overridden in a section via data-*) */
  --card-bg: rgba(12,17,22,0.72);
  --card-radius: 16px;
  --card-padding: clamp(1rem, 3vw, 2rem);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
html { scroll-behavior: smooth; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--fg);
  background: var(--bg);
}

.noscript {
  padding: 1rem;
  background: #c62828;
  color: white;
  text-align: center;
}

/* Controls */
.controls {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 20;
  width: 280px;
  padding: 1rem;
  background: rgba(20,22,26,0.7);
  color: var(--fg);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 12px;
  backdrop-filter: blur(8px);
}
.controls h2 {
  margin: 0 0 0.5rem 0;
  font-size: 1rem;
  color: #e2e8f0;
}
.control { margin: 0.5rem 0; }
.control.inline { display: flex; align-items: center; gap: 0.5rem; }
.control label { display: block; font-size: 0.875rem; color: var(--muted); margin-bottom: 0.25rem; }
.control input[type="range"] { width: 100%; }
.control output { font-variant-numeric: tabular-nums; margin-left: 0.5rem; color: #a0aec0; }

/* Panels */
.panel { position: relative; height: var(--panel-height); }
.panel[data-theme="light"] { color: #0c1116; }

.sticky {
  position: sticky;
  top: 0;
  height: 100vh; /* pin content for a viewport */
  overflow: hidden;
}

.bg-video {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: saturate(0.9) contrast(1.05);
  opacity: 0.999; /* allow transition to apply */
  /* Only transition opacity for crossfades; transform is updated every frame via JS */
  transition: opacity 300ms ease-out;
  will-change: transform, opacity;
}

.overlay {
  position: relative;
  z-index: 2;
  display: flex;
  align-items: center;
  justify-content: center; /* default center */
  height: 100%;
  padding: 4rem 1.5rem;
  text-align: left; /* more natural inside card; can be overridden */
  will-change: transform;
}
.overlay.align-left { justify-content: flex-start; }
.overlay.align-right { justify-content: flex-end; }
.overlay.align-center { justify-content: center; }
/* Match text alignment to placement */
.overlay.align-left { text-align: left; }
.overlay.align-center { text-align: center; }
.overlay.align-right { text-align: right; }

/* Card block (optional, injected via JS when a section sets data-card="true") */
.overlay .card {
  background: var(--card-bg, rgba(12,17,22,0.72));
  border-radius: var(--card-radius, 16px);
  padding: var(--card-padding, clamp(1rem, 3vw, 2rem));
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  max-width: var(--overlay-max);
}
.overlay .card.no-surface {
  background: transparent;
  box-shadow: none;
}
.overlay.align-center .card { margin: 0 auto; }

.overlay h1 { font-size: clamp(2rem, 6vw, 4rem); margin: 0.25rem 0 0.75rem; color: #e5edf6; }
.overlay p {
  font-size: clamp(1rem, 2.2vw, 1.35rem);
  line-height: 1.75;
  letter-spacing: 0.01em;
  max-width: var(--overlay-max);
  margin: 0.75rem 0 1.1rem;
  color: #e5edf6;
}

/* Light mode: apply when a section sets data-theme="light" */
.panel[data-theme="light"] .overlay h1,
.panel[data-theme="light"] .overlay p {
  color: #0c1116;
}
.panel[data-theme="light"] .overlay .card {
  background: rgba(255,255,255,0.82);
  color: #0c1116;
}


/* Clip-path masks (applied to the sticky container so both video and text are clipped) */
.panel[data-mask="diag-down"] .sticky {
  /* top-left higher, top-right lower -> diagonal down */
  clip-path: polygon(0 4vw, 100% 0, 100% calc(100% - 4vw), 0% 100%);
}
.panel[data-mask="diag-up"] .sticky {
  /* top-right higher, top-left lower -> diagonal up */
  clip-path: polygon(0 0, 100% 4vw, 100% 100%, 0% calc(100% - 4vw));
}
.panel[data-mask="taper-right"] .sticky {
  /* top slants up to the right; bottom slants down to the right -> narrower on right */
  clip-path: polygon(
    0% 4vw, 100% 0,
    100% 100%, 0% calc(100% - 4vw)
  );
}
.panel[data-mask="taper-left"] .sticky {
  /* top slants down to the right; bottom slants up to the right -> narrower on left */
  clip-path: polygon(
    0% 0, 100% 4vw,
    100% calc(100% - 4vw), 0% 100%
  );
}
.panel[data-mask="curve-bottom"] .sticky {
  /* polygonal approximation of a gentle bottom curve */
  clip-path: polygon(
    0% 0%, 100% 0%, 100% 85%,
    80% 92%, 50% 96%, 20% 92%,
    0% 85%
  );
}
.panel[data-mask="curve-top"] .sticky {
  /* polygonal approximation of a gentle top curve */
  clip-path: polygon(
    0% 10%, 20% 8%, 50% 4%, 80% 8%, 100% 10%,
    100% 100%, 0% 100%
  );
}

/* Fallback for browsers without clip-path/path support: no clipping */
@supports not (clip-path: polygon(0 0, 100% 0, 100% 100%)) {
  .panel [class*="sticky"] { clip-path: none; }
}

/* Responsive tweak for small screens */
@media (max-width: 640px) {
  .controls { width: calc(100% - 2rem); left: 1rem; right: 1rem; }
}
